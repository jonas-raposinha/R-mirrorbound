# R-mirrorbound
Comparison of boundary conditions for signal processing 

In signal processing, we are often faced with issues relating to the fact that we are dealing with signals that are limited in time (or space for image processing). This means that the signal is not infinite and thus has boudaries. This becomes an issue for tools such as the fourier transform, which operates on periodic functions, or filtering approaches, which transform signal data using information from adjacent data points. I will start with the common disclaimer that there is no one magic bullet in terms of boundary conditions. Any solution will have to make certain assumptions about the data in order to provide the "missing" data points outside of the boundaries. With that said, let's look at some approaches to tackle this, namely ignoring the boundary, zero padding, boundary replication, circular replication and symmetric replication (mirroring).

The simplest way is probably to just ignore the boundary values and confine the treatment inside the data, including the untreated boundary in the output or cropping it away. This can work well for some situations, eg if the boundaries are not really important or the treatment "neightbourhood" is very small compared to the data set.

A common approach is called "zero padding" and does exactly that; it wraps the original data set in layers of zeros that can then be used to apply the treatment to the boundaries. The treatment neighbourhood size determines the number of layers of zeros. Since not all signals start and end close to zero though, this approach often distorts the boundaries significantly. In image processing, this is sometimes referred to as a "dark band" effect, since when applied before a lowpass filter, it makes the boundary of the image darker (intensity closer to zero). For this reason, this approach may work better on [baseline corrected data](https://github.com/jonas-raposinha/R-trend-correct). That might not be very useful though, as several baseline correction approaches requires boundary conditions. 

The data set can also be padded with constant value over than zero, eg replicating the value at the boundary. This eliminates the distortion due to a signal shift at the boundary but instead tends to overemphasize the effect the boundary carries to its neighbourhood. Also, constant padding (including zero padding) has the disadvantage of producing non-consistent results when applying filters, ie the filtered signal is not a constant value signal at the boundary.

The next step up is to leave constant padding and introduce periodicity, ie repeating the entire signal. Assuming a periodic signal can be great when you have reason to do so, which requires knowledge of the nature of the signal. This is sometimes referred to as circular padding and is a standard approach for DFT (digital fourier transform). This might also introduce signal shifts though, if the signal does not start and end with similar values, prompting the use of window functions that make the signal taper towards zero outside a given interval (link?).

Alternatively, an approach can be used where the signal is mirrored (folded) around the boundary. Although slightly trickier to implement, this is my standard approach for most applications. Due to the folding across the boundary, it is more tolerant towards a wider variety of signals and does not require additional processing, eg window functions or boundary trimming, to avoid boundary artifacts. Both signal repeating approaches produce consistent results, ie filtering of a periodic signal gives a periodic signal and the same for a mirrored signal.
